This is based on Signal open source.
